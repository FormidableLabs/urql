<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test For Loop</title>
    <script>
        window.process = { env: { NODE_ENV: "development" } };
    </script>
</head>

<body>
    <div id="root"></div>
    <script type="module">
        import urqlClient, { cache } from './urqlClient.js';
        import * as bench from '/bench.js';

        // create a function that will take in a number of times to be run and a function that will produce an entry/entity
        const makeEntries = (amount, makeEntry) => {
            // create array of entries to be outputted
            const entries = [];
            // iterate from 0 up to the amount inputted
            for (let i = 0; i < amount; i += 1) {
                // each iteration, create an entry and pass it the current index & push it into output array
                const entry = makeEntry(i);
                entries.push(entry);
            }
            // return array of entries
            return entries;
        };

        // create a function that will produce Todo entries
        // will take in number relative to iterator count
        const makeTodo = num => ({
            id: `${num}`,
            text: `Todo ${num}`,
            complete: Boolean(num % 2),
        });

        // create different variations of entries
        const hundredTodos = makeEntries(100, makeTodo);
        const thousandTodos = makeEntries(1000, makeTodo);
        const tenThousandTodos = makeEntries(10000, makeTodo);

        // create queries to be performed
        const ALL_TODOS_QUERY = `
            query ALL_TODOS_QUERY {
                todos {
                    id,
                    text,
                    complete
                }
            }
        `;
        const ADD_TODO_MUTATION = `
            mutation ADD_TODO_MUTATION($text: String!, $complete: Boolean!){
                addTodo(text: $text, complete: $complete){
                    id,
                    text,
                    complete
                }
            }
        `;
        const ADD_TODOS_MUTATION = `
            mutation ADD_TODOS_MUTATION($newTodos: NewTodosInput!){
                addTodos(newTodos: $newTodos){
                    id,
                    text,
                    complete
                }
            }
        `;

        // create functions that execute operations to be benchmarked
        const getAllTodos = async () => {
            const queryResult = await urqlClient.query(ALL_TODOS_QUERY).toPromise();
            console.log("getAllTodoss Query Result", queryResult);
        };
        const addTodo = async () => {
            const newTodo = { text: 'New todo', complete: true };
            const mutationResult = await urqlClient.mutation(ADD_TODO_MUTATION, newTodo).toPromise();
            console.log("addTodo Mutation Result", mutationResult);
        };
        const addHundredTodos = async () => {
            const newTodos = { newTodos: { todos: hundredTodos } };
            const mutationResult = await urqlClient.mutation(ADD_TODOS_MUTATION, newTodos).toPromise();
            console.log("100 addTodos Mutation Result", mutationResult);
        };
        const addThousandTodos = async () => {
            const newTodos = { newTodos: { todos: thousandTodos } };
            const mutationResult = await urqlClient.mutation(ADD_TODOS_MUTATION, newTodos).toPromise();
            console.log("1000 addTodos Mutation Result", mutationResult);
        };
        const addTenThousandTodos = async () => {
            const newTodos = { newTodos: { todos: tenThousandTodos } };
            const mutationResult = await urqlClient.mutation(ADD_TODOS_MUTATION, newTodos).toPromise();
            console.log("10000 addTodos Mutation Result", mutationResult);
        };

        getAllTodos();
        addTodo();
        addHundredTodos()
        // addThousandTodos();
        // addTenThousandTodos();
        bench.start();
        getAllTodos();
        bench.stop();

    </script>
</body>

</html>